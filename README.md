# STM32Project
存放学习过的STM32项目



# FreeRTOS

FreeRTOS的示例

- 开发环境：VS Code + EIDE插件
- 硬件：STM32F103C8T6最小系统板

## 示例1 队列

**硬件接线**

|   器件   | 器件引脚 |   STM32引脚   |
| :------: | :------: | :-----------: |
| 光敏电阻 |    AO    |      PB1      |
|   OLED   |   SCL    |      PB6      |
|          |   SDA    |      PB7      |
|          |   VCC    |      PB5      |
|          |   GND    |      PB4      |
| 3个LED灯 |    -     | PA0、PA1、PA2 |

**光照采集、LED、OLED任务**

光敏传感器采集光照强度；LED1~LED3反应光照的强度，3灯全亮表示最暗，灯全部熄灭表示最亮；OLED实时显示光照强度。

任务分析：

- OLED显示光照强度，任务优先级最低
- LED亮灭任务，任务优先级中
- 光照采集任务，光敏电阻使用ADC读取，范围0~4095，任务优先级高

使用两个队列，xLightQueue接收光照数据并发送给LED亮灭任务，LED亮灭任务将接收到的数据发送xDisplayQueue用于OLED显示任务，整个过程：

**光照采集任务**-----发送数据---->xLightQueue------读取数据----->**LED亮灭任务**-----发送数据---->xDisplayQueue------读取数据----->**OLED显示任务**

## 示例2 信号量

**硬件接线**

|   器件   | 器件引脚 |   STM32引脚   |
| :------: | :------: | :-----------: |
| 光敏电阻 |    AO    |      PB1      |
| 按键1、2 |    -     |   PB0、PB11   |
|   OLED   |   SCL    |      PB6      |
|          |   SDA    |      PB7      |
|          |   VCC    |      PB5      |
|          |   GND    |      PB4      |
| 3个LED灯 |    -     | PA0、PA1、PA2 |

**任务需求**，四个任务：

- 光照采集任务：当采集的光照强度小于阈值，向LED任务发送二值信号量
- LED任务：接收到来自光照采集任务的二值信号量，点亮LED灯，并释放二值信号量
- 按键任务：Key1、Key2两个按键，按下Key1，计数信号量+1，按下Key2，计数信号量-1，上限为10
- OLED任务：实时显示光照强度、显示LED亮灭情况、显示已用资源个数（上限为10个）

**优先级划分**：按键任务 > OLED任务 > 光照采集任务 > LED任务

